@using personal_blog.core.Models
@rendermode InteractiveWebAssembly

<MudTextField T="string"
              ValueChanged="FilterPosts"
              Placeholder="Search..." 
              Adornment="Adornment.Start"
              AdornmentIcon="@Icons.Material.Filled.Search"
              Clearable="true"
              DebounceInterval="250"/>
@if (_filteredPosts.Count > 0)
{
    <PostCard Posts="_filteredPosts"/>
}
else
{
    <PostCard Posts="Posts"/>
}


@code {
    [Parameter] 
    public List<Post> Posts { get; set; } = [];
    private List<Post> _filteredPosts =[];
    
    private void FilterPosts(string searchQuery)
    {
        if (string.IsNullOrWhiteSpace(searchQuery))
        {
            _filteredPosts = Posts;
        }
        else
        {
            _filteredPosts = Posts.Where(p => 
                    p.Title.Contains(searchQuery, StringComparison.OrdinalIgnoreCase) ||
                    p.Body.Contains(searchQuery, StringComparison.OrdinalIgnoreCase))
                .ToList();
        }
    }
}